<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>BNB CanlÄ± & Sanal Bot Panel</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body { font-family: Arial; margin: 20px; background:#f4f4f4; }
.panel { display:flex; gap:20px; flex-wrap:wrap; }
.box { background:#fff; padding:20px; border-radius:10px; flex:1; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
#log { max-height:200px; overflow-y:auto; background:#eee; padding:10px; border-radius:5px; }
button { padding:10px 20px; margin-top:10px; cursor:pointer; }
</style>
</head>
<body>
<h1>BNB CanlÄ± & Sanal Bot Panel</h1>

<div class="panel">
  <div class="box">
    <h2>RSI6 GÃ¼ncel</h2>
    <div id="rsiValue" style="font-size:2em;">--</div>
    <button onclick="manualBuy()">CanlÄ± AlÄ±m</button>
    <button onclick="manualSell()">CanlÄ± SatÄ±ÅŸ</button>
  </div>
  <div class="box">
    <h2>Sanal Bakiye</h2>
    <div id="balance">9 USDT</div>
    <h3>Son Ä°ÅŸlemler</h3>
    <div id="log"></div>
  </div>
</div>

<div class="box" style="margin-top:20px;">
  <h2>RSI6 Trend GrafiÄŸi</h2>
  <canvas id="rsiChart" height="100"></canvas>
</div>

<script>
let rsiData = [], labels = [];
let log = document.getElementById("log");

function updatePanel(rsiHistory, balance){
  if(rsiHistory.length===0) return;
  rsiData = rsiHistory.map(d=>d.rsi);
  labels = rsiHistory.map(d=>d.time);
  chart.update();
  document.getElementById("rsiValue").innerText = rsiData[rsiData.length-1].toFixed(1);
  document.getElementById("balance").innerText = balance.toFixed(2) + " USDT";
  log.innerHTML = `<div style="color:green;">ðŸ“‰ RSI${rsiData[rsiData.length-1].toFixed(1)} â†’ Sanal AlÄ±m YapÄ±ldÄ±</div>` + log.innerHTML;
}

const ctx = document.getElementById('rsiChart').getContext('2d');
const chart = new Chart(ctx, {
  type: 'line',
  data: { labels, datasets: [{ label: 'RSI6', data: rsiData, borderColor: 'blue', fill: false }] },
  options: { scales: { y: { min:0, max:100 } } }
});

function manualBuy(){ log.innerHTML = `<div style="color:blue;">ðŸ’° CanlÄ± AlÄ±m YapÄ±ldÄ±</div>` + log.innerHTML; }
function manualSell(){ log.innerHTML = `<div style="color:red;">ðŸ’µ CanlÄ± SatÄ±ÅŸ YapÄ±ldÄ±</div>` + log.innerHTML; }

setInterval(async()=>{
  try{
    const res = await fetch('/rsi');
    const data = await res.json();
    updatePanel(data.rsi, data.balance);
  } catch(e){
    log.innerHTML = `<div style="color:red;">âš  AlÄ±namadÄ±</div>` + log.innerHTML;
  }
},15000);
</script>
</body>
</html>
